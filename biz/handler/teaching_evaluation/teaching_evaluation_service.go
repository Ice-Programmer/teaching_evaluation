// Code generated by hertz generator.

package teaching_evaluation

import (
	"context"
	"fmt"
	"github.com/cloudwego/hertz/pkg/common/hlog"
	"teaching_evaluation_backend/handler"
	"teaching_evaluation_backend/handler/student"
	"teaching_evaluation_backend/handler/student_class"
	"teaching_evaluation_backend/utils"

	"github.com/cloudwego/hertz/pkg/app"
	"github.com/cloudwego/hertz/pkg/protocol/consts"
	"teaching_evaluation_backend/biz/model/teaching_evaluation"
)

// Ping .
// @router /api/v1/itmo/teaching/evaluation/ping [POST]
func Ping(ctx context.Context, c *app.RequestContext) {
	hlog.CtxInfof(ctx, "received ping request")
	var req teaching_evaluation.PingRequest
	err := c.BindAndValidate(&req)
	if err != nil {
		c.String(consts.StatusBadRequest, err.Error())
		return
	}

	resp := &teaching_evaluation.PingResponse{
		BaseResp: handler.ConstructSuccessResp(),
		Response: utils.StringPtr("pong"),
	}

	c.JSON(consts.StatusOK, resp)
}

// CreateStudentClass .
// @router /api/v1/itmo/teaching/evaluation/student/class/create [POST]
func CreateStudentClass(ctx context.Context, c *app.RequestContext) {
	var req teaching_evaluation.StudentClassCreateRequest
	err := c.BindAndValidate(&req)
	if err != nil {
		hlog.CtxErrorf(ctx, "参数错误: %v", err)
		c.String(consts.StatusBadRequest, err.Error())
		return
	}

	resp, err := student_class.CreateStudentClass(ctx, &req)
	if err != nil {
		hlog.CtxErrorf(ctx, "CreateStudentClass error: %s", err.Error())
		resp = &teaching_evaluation.StudentClassCreateResponse{
			BaseResp: handler.GenErrorBaseResp(fmt.Sprintf("create student class error, err: %v", err)),
		}
	}

	c.JSON(consts.StatusOK, resp)
}

// EditStudentClass .
// @router /api/v1/itmo/teaching/evaluation/student/class/edit [POST]
func EditStudentClass(ctx context.Context, c *app.RequestContext) {
	var req teaching_evaluation.StudentClassEditRequest
	err := c.BindAndValidate(&req)
	if err != nil {
		c.String(consts.StatusBadRequest, err.Error())
		return
	}

	resp, err := student_class.EditStudentClass(ctx, &req)
	if err != nil {
		hlog.CtxErrorf(ctx, "EditStudentClass error: %s", err.Error())
		resp = &teaching_evaluation.StudentClassEditResponse{
			BaseResp: handler.GenErrorBaseResp(err.Error()),
		}
	}

	c.JSON(consts.StatusOK, resp)
}

// BatchCreateStudentClass .
// @router /api/v1/itmo/teaching/evaluation/student/class/create/batch [POST]
func BatchCreateStudentClass(ctx context.Context, c *app.RequestContext) {
	var req teaching_evaluation.BatchCreateStudentClassRequest
	err := c.BindAndValidate(&req)
	if err != nil {
		c.String(consts.StatusBadRequest, err.Error())
		return
	}

	resp, err := student_class.BatchCreateStudentClass(ctx, &req)
	if err != nil {
		hlog.CtxErrorf(ctx, "Batch Create Student error: %s", err.Error())
		resp = &teaching_evaluation.BatchCreateStudentClassResponse{
			BaseResp: handler.GenErrorBaseResp(err.Error()),
		}
	}

	c.JSON(consts.StatusOK, resp)
}

// CreateStudent .
// @router /api/v1/itmo/teaching/evaluation/student/create [POST]
func CreateStudent(ctx context.Context, c *app.RequestContext) {
	var req teaching_evaluation.CreateStudentRequest
	err := c.BindAndValidate(&req)
	if err != nil {
		c.String(consts.StatusBadRequest, err.Error())
		return
	}

	resp, err := student.CreateStudent(ctx, &req)
	if err != nil {
		hlog.CtxErrorf(ctx, "CreateStudent error: %s", err.Error())
		resp = &teaching_evaluation.CreateStudentResponse{
			BaseResp: handler.GenErrorBaseResp(err.Error()),
		}
	}

	c.JSON(consts.StatusOK, resp)
}

// BatchCreateStudent .
// @router /api/v1/itmo/teaching/evaluation/student/create/batch [POST]
func BatchCreateStudent(ctx context.Context, c *app.RequestContext) {
	var req teaching_evaluation.BatchCreateStudentRequest
	err := c.BindAndValidate(&req)
	if err != nil {
		c.String(consts.StatusBadRequest, err.Error())
		return
	}

	resp, err := student.BatchCreateStudent(ctx, &req)
	if err != nil {
		hlog.CtxErrorf(ctx, "Batch Create Student error: %s", err.Error())
		resp = &teaching_evaluation.BatchCreateStudentResponse{
			BaseResp: handler.GenErrorBaseResp(err.Error()),
		}
	}

	c.JSON(consts.StatusOK, resp)
}

// EditStudent .
// @router /api/v1/itmo/teaching/evaluation/student/edit [POST]
func EditStudent(ctx context.Context, c *app.RequestContext) {
	var req teaching_evaluation.EditStudentRequest
	err := c.BindAndValidate(&req)
	if err != nil {
		c.String(consts.StatusBadRequest, err.Error())
		return
	}

	resp, err := student.EditStudent(ctx, &req)
	if err != nil {
		hlog.CtxErrorf(ctx, "EditStudent error: %s", err.Error())
		resp = &teaching_evaluation.EditStudentResponse{
			BaseResp: handler.GenErrorBaseResp(err.Error()),
		}
	}

	c.JSON(consts.StatusOK, resp)
}
